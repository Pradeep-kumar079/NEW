<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Select Divs</title>
  <style>
    .selectable {
      width: 60px;
      height: 30px;
      margin: 10px;
      background-color: lightblue;
      display: flex;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .selected {
      background-color: lightgreen;
    }
    .disabled {
      background-color: grey;
      pointer-events: none;
    }
    .selected-divs {
      margin-top: 20px;
    }
    .decks{
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: flex-start;
      border: 1px solid black;
      box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
      height: auto;
      width: 900px;
      padding: 20px;
      border-radius: 6px;
      position: relative;
      text-align: center;
      margin-top: 30px;

    }
    #deckh2{
      margin-left: 350px;
    }
    .lower_deck{
      display: flex;
      flex-direction: column;
      border: 1px solid black;
      margin-top: 20px;
      margin-left: 40px;
      
    }
    .upper_deck{
      display: flex;
      flex-direction: column;
      border: 1px solid black;
      margin-top: 20px;
      margin-left: 40px;

      
    }
    .deck1{
      display: flex;
      flex-direction: row;
      text-align: center;
    }
    .deck2{
      display: flex;
      flex-direction: row;
      text-align: center;
    }
    .informations{
      height: auto;
      width: 400px;
      border: 1px solid black;
      display: flex;
      flex-direction: column;
      margin-left: 1000px;
      margin-top: -500px;
      padding: 20px;
      
    }
    .informations input{
      margin-top: 10px;
    }
    .seats_container{
      display: flex;
      flex-direction: row;
      height: auto;
      width: auto;
    }
    .instructions{
      height: 400px;
      width: 300px;
      border: 1px solid black;
      margin-left: 1100px;
      margin-top: -450px;
      display: flex;
      flex-direction: row;
      justify-content:space-around;
      padding: 30px;
      box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
      border-radius: 5px;
      
    }
    .instructions p{
      display: flex;
      flex-direction: column;
      width: auto;
      margin-top: 30px;
    }
#sendToBackendBtn{
  width: 120px;
  margin-left: 350px;
  background-color: rgb(100, 186, 100);
  margin-top: 50px;
  
}
.available{
  height: 100px;
  width: 60px;
  border: 1px solid black;
  background-color: green;
  text-align: center;
}
.notavailable{
  height: 100px;
  width: 60px;
  border: 1px solid black;
  background-color: rgb(121, 169, 191);
  margin-top: 40px;
  text-align: center;
}

  </style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>
<body>

  <div class="seats_container">
  <form action="/sendSelectedDivs" method="POST">

 
  <div class="decks">
    <h2 id="deckh2">Please select seats</h2>
  <div class="lower_deck">
    <h3>Lower Deck</h3>
    <div class="deck1">
  <div class="selectable" id="L1">L1</div>
  <div class="selectable" id="L2">L2</div>
  <div class="selectable" id="L3">L3</div>
  <div class="selectable" id="L4">L4</div>
  <div class="selectable" id="L5">L5</div>
  <div class="selectable" id="L6">L6</div>
  <div class="selectable" id="L7">L7</div>
  <div class="selectable" id="L8">L8</div>
  <div class="selectable" id="L9">L9</div>
  <div class="selectable" id="L10">L10</div>
</div>
<div class="deck2">
  <div class="selectable" id="L11">L11</div>
  <div class="selectable" id="L12">L12</div>
  <div class="selectable" id="L13">L13</div>
  <div class="selectable" id="L14">L14</div>
  <div class="selectable" id="L15">L15</div>
  <div class="selectable" id="L16">L16</div>
  <div class="selectable" id="div7">L17</div>
  <div class="selectable" id="L18">L18</div>
  <div class="selectable" id="L19">L19</div>
  <div class="selectable" id="L20">L20</div>
</div>
</div>
<div class="upper_deck">
  <h3>Upper Deck</h3>
  <div class="deck1">
  <div class="selectable" id="U1">U1</div>
  <div class="selectable" id="U2">U2</div>
  <div class="selectable" id="U3">U3</div>
  <div class="selectable" id="U4">U4</div>
  <div class="selectable" id="U5">U5</div>
  <div class="selectable" id="U6">U6</div>
  <div class="selectable" id="L7">L7</div>
  <div class="selectable" id="U8">U8</div>
  <div class="selectable" id="U9">U9</div>
  <div class="selectable" id="U10">U10</div>
</div>
<div class="deck2">
  <div class="selectable" id="U11">U11</div>
  <div class="selectable" id="U12">U12</div>
  <div class="selectable" id="U13">U13</div>
  <div class="selectable" id="U14">U14</div>
  <div class="selectable" id="U15">U15</div>
  <div class="selectable" id="U16">U16</div>
  <div class="selectable" id="U17">U17</div>
  <div class="selectable" id="U18">U18</div>
  <div class="selectable" id="U19">U19</div>
  <div class="selectable" id="U20">U20</div>
</div>
</div>

<div class="selected-divs">
  <h3>Selected Seats:</h3>
  <ul id="selectedDivList"></ul>
</div>
<button id="sendToBackendBtn">Select</button>

  
</form>

<div class="instructions">
  <div class="instructdivs">
    <div class="available"> available</div>
    <div class="notavailable"> not available</div>
  </div>
  <ul>
    <li> <p><strong>green</strong> indicates seat is already booked</p></li>
    <li> <p> <strong>violates</strong> indicates seat is empty</p></li>
  </ul>
  
</div>

</div>



  <script>
    let selectedDivs = [];

    const divs = document.querySelectorAll('.selectable');
    const selectedDivList = document.getElementById('selectedDivList');
    const sendToBackendBtn = document.getElementById('sendToBackendBtn');

    divs.forEach(div => {
      div.addEventListener('click', () => {
        if (div.classList.contains('selected')) {
          div.classList.remove('selected');
          selectedDivs = selectedDivs.filter(selected => selected !== div.id);
        } else {
          div.classList.add('selected');
          selectedDivs.push(div.id);
        }

        divs.forEach(d => {
          if (selectedDivs.includes(d.id)) {
          // d.classList.add('disabled');
          } else {
            d.classList.remove('disabled');
          }
        });

        updateSelectedDivList();
      });
    });

    function updateSelectedDivList() {
      selectedDivList.innerHTML = '';
      selectedDivs.forEach(id => {
        const li = document.createElement('li');
        li.textContent = id;
        selectedDivList.appendChild(li);
      });
    }

    sendToBackendBtn.addEventListener('click', async () => {
      if (selectedDivs.length === 0) {
        alert('No divs selected.');
        return;
      }

      const response = await fetch('/sendSelectedDivs', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ selectedDivs }),
      });

      if (response.ok) {
        alert('Seat selected successfully!');
        res.render("details" ,{selectedDivs});
      } else {
        alert('Error sending data to backend');
      }
    });
  </script>
  
</body>
</html>
